{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '47502659-8e710eb0ff3e952458316b5b2';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        page: page,\n        per_page: perPage,\n        image_type: 'photo',\n        orientation: 'horizontal',\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Ошибка запроса:', error);\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function renderGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  const markup = images\n    .map(\n      (image) => `\n      <div class=\"photo-card\">\n        <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes</b> ${image.likes}</p>\n          <p class=\"info-item\"><b>Views</b> ${image.views}</p>\n          <p class=\"info-item\"><b>Comments</b> ${image.comments}</p>\n          <p class=\"info-item\"><b>Downloads</b> ${image.downloads}</p>\n        </div>\n      </div>`\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  // Инициализация SimpleLightbox\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionSelector: 'img', // использование изображения в качестве подписи\n    captionType: 'alt', // использование атрибута alt для подписи\n    captionDelay: 250,\n    overlay: true, // затемнение фона\n    stopPropagation: true // отключение пассивных слушателей\n  });  \n}\n\n\nexport function hideLoadMoreButton() {\n  const loadMoreButton = document.querySelector('.load-more');\n  if (loadMoreButton) {\n    loadMoreButton.style.display = 'none';\n  }\n}\n\nexport function showLoadMoreButton() {\n  const loadMoreButton = document.querySelector('.load-more');\n  if (loadMoreButton) {\n    loadMoreButton.style.display = 'block';\n  }\n}\n","import { fetchImages } from './js/pixabay-api';\nimport { renderGallery, showLoadMoreButton, hideLoadMoreButton } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Настройки iziToast\niziToast.settings({\n  theme: 'dark',\n  position: 'topRight',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nlet query = '';\nlet page = 1;\n\nconst searchForm = document.querySelector('#search-form');\nconst loadMoreButton = document.querySelector('.load-more');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.createElement('span');\nloader.className = 'loader hidden';\ndocument.body.append(loader);\n\nsearchForm.addEventListener('submit', onSearchSubmit);\nloadMoreButton.addEventListener('click', onLoadMoreClick);\n\nfunction toggleLoader(show) {\n  loader.classList.toggle('hidden', !show);\n}\n\nasync function onSearchSubmit(e) {\n  e.preventDefault();\n\n  query = e.target.elements.query.value.trim();\n  if (!query) return;\n\n  page = 1;\n  gallery.innerHTML = ''; // Удаляем предыдущие результаты\n  hideLoadMoreButton();\n  toggleLoader(true);\n\n  try {\n    const data = await fetchImages(query, page);\n    toggleLoader(false);\n\n    if (data.hits.length === 0) {\n      iziToast.warning({\n        title: 'Уведомление',\n        message: 'Ничего не найдено. Попробуйте изменить запрос.',\n      });\n      return;\n    }\n\n    renderGallery(data.hits);\n    showLoadMoreButton();\n  } catch (error) {\n    toggleLoader(false);\n    iziToast.error({\n      title: 'Ошибка',\n      message: 'Не удалось загрузить данные. Повторите попытку позже.',\n    });\n  }\n}\n\nasync function onLoadMoreClick() {\n  page += 1;\n  toggleLoader(true);\n\n  try {\n    const data = await fetchImages(query, page);\n    toggleLoader(false);\n\n    if (data.hits.length === 0 || page * 15 >= data.totalHits) {\n      hideLoadMoreButton();\n      iziToast.info({\n        title: 'Конец',\n        message: 'Вы достигли конца результатов поиска.',\n      });\n    } else {\n      renderGallery(data.hits);\n    }\n  } catch (error) {\n    toggleLoader(false);\n    iziToast.error({\n      title: 'Ошибка',\n      message: 'Не удалось загрузить данные. Повторите попытку позже.',\n    });\n  }\n}\n\nwindow.addEventListener('scroll', () => {\n  if (window.innerHeight + window.scrollY >= document.documentElement.scrollHeight - 100) {\n    onLoadMoreClick();\n  }\n});\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","perPage","axios","error","renderGallery","images","gallery","markup","image","SimpleLightbox","hideLoadMoreButton","loadMoreButton","showLoadMoreButton","iziToast","searchForm","loader","onSearchSubmit","onLoadMoreClick","toggleLoader","show","data"],"mappings":"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"}